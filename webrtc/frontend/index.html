<!DOCTYPE html>
<html lang="en">
<head>
    <title>Websockets with Earnstein</title>
</head>
<body>
    <div class="center">
        <h1>Granular x chat application.</h1>
        <h3 id="chat-header">Currently in chat: general</h3>
        <form id="chatroom-selection">
            <label for="chatroom" >Chatroom:</label>
            <input type="text" id="chatroom" name="chatroom"/> <br/>
            <input type="submit" value="Change chatroom">
        </form>
        <br/>
        <textarea name="chatmessages" id="chatmessages" readonly cols="50" rows="5" class="messagearea" placeholder="Welcome to chatroom"></textarea>
        <br/>

        <form id="chatroom-message">
            <label for="message" >Chatroom:</label>
            <input type="text" id="message" name="message"> <br/>
            <input type="submit" value="Send message">
        </form>
    </div>

    <script>
        var selectedChat = "general";
       function changeChatRoom() {
        var newChat = document.getElementById("chatroom")
        if(newChat != null && newChat.value != selectedChat){
            console.log(newChat)
        }
        return false
       }

       function sendMessage() {
        var newMessage = document.getElementById("message")
        if(newMessage != null){
            conn.send(newMessage.value)
        }
        return false
       }

       window.onload = function(){
        document.getElementById("chatroom-selection").onsubmit = changeChatRoom
        document.getElementById("chatroom-message").onsubmit = sendMessage
        if (window["WebSocket"]){
            console.log("web socket supported")
            conn = new WebSocket("ws://localhost:8080/ws");
        }else {
            alert("Browser does not supports websocket")
        }
       }
    </script>


<style type="text/css">
    body {
        overflow:hidden;
        padding: 10px;
        margin : 0;
        width: 100%;
        height: 100%;
        background-color: beige;
    }

    .center {
        margin: auto;
        width: 50%;
        border: 3px solid green;
        padding: 10px;
    }
</style>
</body>
</html>